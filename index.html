<!DOCTYPE html>
<html>
<head>
<title>MusclePortfolio.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="%E7%AD%8B%E8%82%89%E9%98%B2%E8%A1%9B%E3%83%9D%E3%83%BC%E3%83%88%E3%83%95%E3%82%A9%E3%83%AA%E3%82%AA"><strong>「筋肉防衛」ポートフォリオ</strong></h1>
<hr>
<h3 id="%E6%B2%B3%E5%8E%9F%E9%9B%BB%E5%AD%90%E3%83%93%E3%82%B8%E3%83%8D%E3%82%B9%E5%B0%82%E9%96%80%E5%AD%A6%E6%A0%A1-%E3%82%B2%E3%83%BC%E3%83%A0%E3%82%AF%E3%83%AA%E3%82%A8%E3%82%A4%E3%82%BF%E3%83%BC%E7%A7%912%E5%B9%B4">河原電子ビジネス専門学校 ゲームクリエイター科2年</h3>
<h3 id="%E6%B0%8F%E5%90%8D%E5%9F%8E%E3%83%8E%E6%88%B8-%E7%BF%BC">氏名：城ノ戸 翼</h3>
<img src="image/title.png" width="720">
<h1 id="%E7%9B%AE%E6%AC%A1"><strong>目次</strong></h1>
<h4 id="1-%E4%BD%9C%E5%93%81%E6%A6%82%E8%A6%81">1. <a href="#overview">作品概要</a></h4>
<h4 id="2-%E6%93%8D%E4%BD%9C%E8%AA%AC%E6%98%8E">2. <a href="#operation">操作説明</a></h4>
<h4 id="detailssummary3-%E6%8B%85%E5%BD%93%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89summary-31-%E3%82%A8%E3%83%B3%E3%82%B8%E3%83%B3%E9%83%A8%E5%88%86br-32-%E3%82%B2%E3%83%BC%E3%83%A0%E9%83%A8%E5%88%86details"><details><summary>3. <a href="#Code">担当ソースコード</a></summary>　　3.1. <a href="#Code">エンジン部分</a><br>　　3.2. <a href="#GameCode">ゲーム部分</a></details></h4>
<h4 id="detailssummary4-%E6%8A%80%E8%A1%93%E7%B4%B9%E4%BB%8Bsummary-41-%E9%A0%82%E7%82%B9%E3%83%A2%E3%83%BC%E3%83%95%E3%81%AB%E3%82%88%E3%82%8B%E7%AD%8B%E8%82%89%E3%81%AE%E8%A1%A8%E7%8F%BEbr-42-%E6%95%B5%E3%81%AE%E5%A4%A7%E9%87%8F%E8%A1%A8%E7%A4%BAbr-43-%E3%83%AF%E3%82%A4%E3%83%97%E7%94%BB%E9%9D%A2"><details><summary>4. <a href="#Technology">技術紹介</a></summary>　　4.1. <a href="#Technology">頂点モーフによる筋肉の表現</a><br>　　4.2. <a href="#EnemyTechnology">敵の大量表示</a><br>　　4.3. <a href="#WipeTechnology">ワイプ画面</a></h4>
<h4 id="detailssummary5-%E3%81%93%E3%81%A0%E3%82%8F%E3%81%A3%E3%81%9F%E3%81%A8%E3%81%93%E3%82%8Dsummary-51-%E3%83%AF%E3%82%A4%E3%83%97%E7%94%BB%E9%9D%A2%E3%81%AE%E3%82%A2%E3%82%B9%E3%83%9A%E3%82%AF%E3%83%88%E6%AF%94br-52-%E6%96%87%E7%AB%A0%E3%81%AE%E8%A1%A8%E7%A4%BAbr-53-%E7%B5%8C%E8%B7%AF%E6%8E%A2%E6%9F%BB%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%9F%E3%82%AB%E3%83%A1%E3%83%A9%E7%A7%BB%E5%8B%95br-54-%E6%95%B5%E3%81%8C%E7%99%BA%E5%A3%B0%E3%81%99%E3%82%8Bsebr-55-%E3%83%97%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%81%AE%E6%94%BB%E6%92%83br-56-%E3%83%9F%E3%83%8B%E3%83%9E%E3%83%83%E3%83%97"><details><summary>5. <a href="#Detailed">こだわったところ</a></summary>　　5.1. <a href="#Detailed">ワイプ画面のアスペクト比</a><br>　　5.2. <a href="#Sentence">文章の表示</a><br>　　5.3. <a href="#RouteExploration">経路探査を使ったカメラ移動</a><br>　　5.4. <a href="#EnemySE">敵が発声するSE</a><br>　　5.5. <a href="#PlayerAttack">プレイヤーの攻撃</a><br>　　5.6. <a href="#MiniMap">ミニマップ</a></h4>
<p><a id="overview"></a></p>
<hr>
<h1 id="1-%E4%BD%9C%E5%93%81%E6%A6%82%E8%A6%81"><strong>1. 作品概要</strong></h1>
<ul>
<li>
<h3 id="%E3%82%BF%E3%82%A4%E3%83%88%E3%83%AB"><strong>タイトル</strong></h3>
<ul>
<li>
<h4 id="%E7%AD%8B%E8%82%89%E9%98%B2%E8%A1%9B">筋肉防衛</h4>
</li>
</ul>
</li>
<li>
<h3 id="%E5%AD%A6%E6%A0%A1"><strong>学校</strong></h3>
<ul>
<li>
<h4 id="%E6%B2%B3%E5%8E%9F%E9%9B%BB%E5%AD%90%E3%83%93%E3%82%B8%E3%83%8D%E3%82%B9%E5%B0%82%E9%96%80%E5%AD%A6%E6%A0%A1">河原電子ビジネス専門学校</h4>
</li>
</ul>
</li>
<li>
<h3 id="%E5%88%B6%E4%BD%9C%E4%BA%BA%E6%95%B0"><strong>制作人数</strong></h3>
<ul>
<li>
<h4 id="1%E4%BA%BA">1人</h4>
</li>
</ul>
</li>
<li>
<h3 id="%E8%A3%BD%E4%BD%9C%E6%9C%9F%E9%96%93"><strong>製作期間</strong></h3>
<ul>
<li>
<h4 id="2021%E5%B9%B49%E6%9C%882022%E5%B9%B41%E6%9C%88">2021年9月～2022年1月</h4>
</li>
</ul>
</li>
<li>
<h3 id="%E3%82%B2%E3%83%BC%E3%83%A0%E3%82%B8%E3%83%A3%E3%83%B3%E3%83%AB"><strong>ゲームジャンル</strong></h3>
<ul>
<li>
<h4 id="%E3%82%A2%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%83%BB%E3%82%BF%E3%83%AF%E3%83%BC%E3%83%87%E3%82%A3%E3%83%95%E3%82%A7%E3%83%B3%E3%82%B9">アクション・タワーディフェンス</h4>
</li>
</ul>
</li>
<li>
<h3 id="%E3%83%97%E3%83%AC%E3%82%A4%E4%BA%BA%E6%95%B0"><strong>プレイ人数</strong></h3>
<ul>
<li>
<h4 id="1%E4%BA%BA">1人</h4>
</li>
</ul>
</li>
<li>
<h3 id="%E5%AF%BE%E5%BF%9C%E3%83%8F%E3%83%BC%E3%83%89"><strong>対応ハード</strong></h3>
<ul>
<li>
<h4 id="windows10">Windows10</h4>
<ul>
<li>
<h5 id="%E3%82%AD%E3%83%BC%E3%83%9C%E3%83%BC%E3%83%89">キーボード</h5>
</li>
<li>
<h5 id="xbox360%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%A9%E3%83%BC">Xbox360コントローラー</h5>
</li>
</ul>
</li>
</ul>
</li>
<li>
<h3 id="%E4%BD%BF%E7%94%A8%E8%A8%80%E8%AA%9E"><strong>使用言語</strong></h3>
<ul>
<li>
<h4 id="c">C++</h4>
</li>
<li>
<h4 id="hlsl">HLSL</h4>
</li>
</ul>
</li>
<li>
<h3 id="%E9%96%8B%E7%99%BA%E7%92%B0%E5%A2%83"><strong>開発環境</strong></h3>
<ul>
<li>
<h4 id="%E3%82%A8%E3%83%B3%E3%82%B8%E3%83%B3">エンジン</h4>
<ul>
<li>
<h5 id="%E5%AD%A6%E6%A0%A1%E5%86%85%E8%A3%BD%E3%81%AE%E7%B0%A1%E6%98%93%E3%82%A8%E3%83%B3%E3%82%B8%E3%83%B3directx12">学校内製の簡易エンジン(DirectX12)</h5>
</li>
</ul>
</li>
<li>
<h4 id="%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0">プログラム</h4>
<ul>
<li>
<h5 id="visual-studio-2019">Visual Studio 2019</h5>
</li>
</ul>
</li>
<li>
<h4 id="3d%E3%83%A2%E3%83%87%E3%83%AB">3Dモデル</h4>
<ul>
<li>
<h5 id="3ds-max">3ds MAX</h5>
</li>
</ul>
</li>
<li>
<h4 id="%E3%82%A8%E3%83%95%E3%82%A7%E3%82%AF%E3%83%88">エフェクト</h4>
<ul>
<li>
<h5 id="effeckseer">Effeckseer</h5>
</li>
</ul>
</li>
<li>
<h4 id="%E7%94%BB%E5%83%8F">画像</h4>
<ul>
<li>
<h5 id="adobe-photoshop">Adobe Photoshop</h5>
</li>
<li>
<h5 id="procreate">Procreate</h5>
</li>
</ul>
</li>
<li>
<h4 id="%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E7%AE%A1%E7%90%86">バージョン管理</h4>
<ul>
<li>
<h5 id="git-hub">Git Hub</h5>
</li>
</ul>
</li>
<li>
<h4 id="%E3%82%BF%E3%82%B9%E3%82%AF%E7%AE%A1%E7%90%86">タスク管理</h4>
<ul>
<li>
<h5 id="redmine">Redmine</h5>
</li>
</ul>
</li>
</ul>
</li>
<li>
<h3 id="githuburl"><strong>GitHubURL</strong></h3>
<ul>
<li>https://github.com/tsubasa25/MuscleDefense</li>
</ul>
</li>
</ul>
<ul>
<li>
<h3 id="%E5%82%99%E8%80%83"><strong>備考</strong></h3>
<ul>
<li>第10回ゲームコンペティション「プレイアブル部門」に応募</li>
</ul>
</li>
</ul>
<p><strong>紹介動画</strong></p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/zAxAMgpAHtQ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p><a id="operation"></a></p>
<hr>
<h1 id="2-%E6%93%8D%E4%BD%9C%E8%AA%AC%E6%98%8E"><strong>2. 操作説明</strong></h1>
<img src="image/GamePad.png" width="720">   
<hr>
<p><a id="Code"></a></p>
<h1 id="3-%E6%8B%85%E5%BD%93%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89"><strong>3. 担当ソースコード</strong></h1>
<ul>
<li>
<details><summary>3.1. エンジン部分</summary>
* AnimationClip.cpp
  * (16行目~ResourceBankManager追加)
<ul>
<li>Material.cpp
<ul>
<li>(InitTexture関数で各テクスチャのリソースを最適化)</li>
<li>(頂点モーフ用の頂点情報を追加)</li>
<li>(シェーダーのリソースを最適化)</li>
</ul>
</li>
<li>Material.h
<ul>
<li>(リソースを最適化するにあたり、Texture型の変数をポインタに変更)</li>
</ul>
</li>
<li>Model.cpp
<ul>
<li>(モデルのリソースを最適化)</li>
<li>(Draw関数を複数のカメラに対応)</li>
</ul>
</li>
<li>Model.h
<ul>
<li>(頂点モーフ用のデータ追加)</li>
</ul>
</li>
<li>RenderContext.h
<ul>
<li>(レンダリングを分割するための情報を追加)</li>
</ul>
</li>
<li>Skeleton.cpp
<ul>
<li>(ボーン情報のリソースを最適化)</li>
</ul>
</li>
<li>TkmFile.cpp
<ul>
<li>(Load関数でガリガリのモデルと、ムキムキのモデルを読み込みするように変更)</li>
</ul>
</li>
<li>GameObjectManager.cpp
<ul>
<li>(影、ワイプ画面を表示するように変更)
<a id="GameCode"></a></li>
</ul>
</li>
</ul>
</li>
<li>
<details><summary>3.2. ゲーム部分(.cpp,.h)</summary>
<ul>
<li>DirectionLight.cpp</li>
<li>DirectionLight.h</li>
<li>EnemySEManager.cpp</li>
<li>EnemySEManager.h</li>
<li>FontRender.cpp</li>
<li>FontRender.h</li>
<li>GaussianBlur.cpp</li>
<li>GaussianBlur.h</li>
<li>LughtManager.cpp</li>
<li>LughtManager.h</li>
<li>PointLight.cpp</li>
<li>PointLight.h</li>
<li>PostEffectManager.cpp</li>
<li>PostEffectManager.h</li>
<li>SkinModelRender.cpp</li>
<li>SkinModelRender.h</li>
<li>SpotLight.cpp</li>
<li>SpotLight.h</li>
<li>BackGround.cpp</li>
<li>BackGround.h</li>
<li>Enemy.cpp</li>
<li>Enemy.h</li>
<li>EnemyAnimation.cpp</li>
<li>EnemyAnimation.h</li>
<li>GameScene.cpp</li>
<li>GameScene.h</li>
<li>GoldGym.cpp</li>
<li>GoldGym.h</li>
<li>HUD.cpp</li>
<li>HUD.h</li>
<li>Level3D.cpp</li>
<li>Level3D.h</li>
<li>main.cpp</li>
<li>Map.cpp</li>
<li>Map.h</li>
<li>MapChap.cpp</li>
<li>MapChap.h</li>
<li>NaviMesh.cpp</li>
<li>NaviMesh.h</li>
<li>Path.cpp</li>
<li>Path.h</li>
<li>PathFinding.cpp</li>
<li>PathFinding.h</li>
<li>PhysicsGhostObject.cpp</li>
<li>PhysicsGhostObject.h</li>
<li>Player.cpp</li>
<li>Player.h</li>
<li>PlayerAnimation.cpp</li>
<li>PlayerAnimation.h</li>
<li>PlayerVoice.cpp</li>
<li>PlayerVoice.h</li>
<li>ResourceBanckManager.cpp</li>
<li>ResourceBanckManager.h</li>
<li>ResultScene.cpp</li>
<li>ResultScene.h</li>
<li>Sky.cpp</li>
<li>Sky.h</li>
<li>SoundEngine.cpp</li>
<li>SoundEngine.h</li>
<li>SoundSource.cpp</li>
<li>SoundSource.h</li>
<li>SpriteRender.cpp</li>
<li>SpriteRender.h</li>
<li>stdafx.cpp</li>
<li>TitleScene.cpp</li>
<li>TitleScene.h</li>
<li>TknFile.cpp</li>
<li>TknFile.h</li>
<li>WaveFile.cpp</li>
<li>WaveFile.h</li>
<li>WaveFileBank.cpp</li>
<li>WaveFileBank.h</li>
<li>WipeCamera.cpp</li>
<li>WipeCamera.h</li>
</ul>
</li>
<li>
<details><summary> 3.2. ゲーム部分(.fx) </summary> 
<ul>
<li>model.fx</li>
<li>postEffect.fx</li>
<li>shadow.fx</li>
<li>Sky.fx</li>
<li>sprite.fx</li>
</ul>
</li>
</ul>
<p><a id="Technology"></a></p>
<hr>
<h1 id="4-%E6%8A%80%E8%A1%93%E7%B4%B9%E4%BB%8B"><strong>4. 技術紹介</strong></h1>
<h2 id="41-%E9%A0%82%E7%82%B9%E3%83%A2%E3%83%BC%E3%83%95%E3%81%AB%E3%82%88%E3%82%8B%E7%AD%8B%E8%82%89%E3%81%AE%E8%A1%A8%E7%8F%BE">4.1. 頂点モーフによる筋肉の表現</h2>
<p>私が考えるこのゲームの最大の特徴は、筋肉を鍛えて、身体が大きくなることであり、<strong>筋肉の肥大をどう表現するか</strong>が、制作をする上で最初の壁でした。
最初に実装したのは、モデルのボーン情報の拡大率を変化させる方法でした。</p>
  <img src="gif/BoneScale.gif" width="720">
<p>この方法だと、筋肉が大きくなるにつれ、モデルが<strong>崩壊</strong>していきます。<br/>
そこで<strong>ムキムキモデル</strong>と<strong>ガリガリモデル</strong>を用意して頂点を線形補間させていく方法に切り替えました。<br/></p>
  <img src="image/PlayerMuscle.png" width="720">
<p>(3dsMaxでのモデルデータ)<br/></p>
  <img src="image/VertexMorph.png" width="720">
<p>(頂点モーフのイメージ)<br/></p>
  <img src="gif/VertexMorph.gif" width="720">
<p>頂点モーフの実装により、モデルが崩壊することなく、よりリアルな筋肉の表現をすることに成功しました。<br/></p>
<p>上腕の筋肉を大きくしたい場合は、上腕の骨に<strong>関連づいている頂点のみモーフ</strong>しています。このようにすることで、部位ごとの頂点モーフを実現しています。</p>
<img src="gif/PartialVertexMorph.gif" width="720">
<p><a id="EnemyTechnology"></a></p>
<h2 id="42-%E6%95%B5%E3%81%AE%E5%A4%A7%E9%87%8F%E8%A1%A8%E7%A4%BA">4.2. 敵の大量表示</h2>
<p>迫りくる大量のゾンビたちが、このゲームのもう１つの特徴としてあります。<br/>しかし、初期の段階ではゾンビを10体出すだけで、<strong>FPSは15程度に低下</strong>し、ゲームを遊ぶどころではなくなっていました。<br/>
問題点を洗い出していくと、多くの改善点が挙げられました。</p>
<ul>
<li>
<h3 id="%E7%84%A1%E9%A7%84%E3%81%AAdraw%E3%82%B3%E3%83%BC%E3%83%AB"><strong>無駄なDrawコール</strong></h3>
</li>
</ul>
<p>RenderDocを利用して、描画コマンドを確認して、無駄なドローコールがないかを確認したところ、敵が映らないワイプ用のカメラにまで表示してしまっていたので、メインカメラのみ表示するように改良しました。</p>
<p>さらに、カメラ外の敵の表示を削減するために、<strong>視錐台カリング</strong>を実装しました。</p>
   <img src="image/Culling.png" width="720">  
<p>(視錐台カリングのイメージ)</p>
<ul>
<li>
<h3 id="%E5%A4%9A%E3%81%99%E3%81%8E%E3%82%8B%E9%A0%82%E7%82%B9%E6%95%B0"><strong>多すぎる頂点数</strong></h3>
</li>
</ul>
<p>さらに、RenderDocを利用し、Meshビューワーを確認して、モデルの頂点数を調べたところ、敵の頂点数が多く、それがボトルネックになっているのではないかと推測しました。
そこで、試しに敵の頂点を少なくすると処理負荷が大きく下がったので、頂点数の削減を行いました。</p>
<p>25000頂点あったモデルを<strong>5500頂点まで削減</strong>しました。</p>
  <img src="image/EnemyMax.png" width="720"> 
<p>(3dsMaxでのゾンビモデル)</p>
<ul>
<li>
<h3 id="%E7%84%A1%E9%A7%84%E3%81%AA%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%AE%E4%BD%BF%E7%94%A8"><strong>無駄なリソースの使用</strong></h3>
<p>ゾンビをポップさせる時に読み込む、<strong>スキンモデル情報</strong>、<strong>アニメーション情報</strong>、<strong>ボーン情報</strong>、<strong>テクスチャ</strong>、<strong>シェーダー</strong>のリソースを使い回すように変更しました。(Flyweightパターンの実装)
<img src="image/ResourcesBank.png" width="720"></p>
<p>(リソース最適化のイメージ)</p>
</li>
<li>
<h3 id="%E8%A4%87%E9%9B%91%E3%81%AA%E7%89%A9%E7%90%86%E6%BC%94%E7%AE%97"><strong>複雑な物理演算</strong></h3>
<p>カプセル状のコライダーから、スフィア状のコライダーに変更し、複雑だった<strong>計算を単純に</strong>しました。</p>
<img src="image/capsule.png" width="720">
<p>(コライダーのイメージ)</p>
</li>
</ul>
<p>ボトルネックであったこれらの問題を解決し、<strong>200体の敵</strong>を出しても問題なくゲームがプレイできるようになりました。</p>
  <img src="gif/Enemy.gif" width="720">
<p><a id="Detailed"></a></p>
<h1 id="5-%E3%81%93%E3%81%A0%E3%82%8F%E3%81%A3%E3%81%9F%E3%81%A8%E3%81%93%E3%82%8D"><strong>5. こだわったところ</strong></h1>
<ul>
<li>
<h2 id="51-%E3%83%AF%E3%82%A4%E3%83%97%E7%94%BB%E9%9D%A2%E3%81%AE%E3%82%A2%E3%82%B9%E3%83%9A%E3%82%AF%E3%83%88%E6%AF%94">5.1. ワイプ画面のアスペクト比</h2>
<p>普段のワイプ画面のアスペクト比は4:3ですが、全画面表示にしたときに16:9になるように調整しました。</p>
  <img src="gif/Aspect.gif" width="720">
</li>
<li>
<h2 id="52-%E6%96%87%E7%AB%A0%E3%81%AE%E8%A1%A8%E7%A4%BA-a-id%22sentence%22a">5.2. 文章の表示  <a id="Sentence"></a></h2>
</li>
</ul>
<p>文章は1度に出すのではなく、音と同時に1文字ずつ表示しています。</p>
  <img src="gif/Sentence.gif" width="720">
<ul>
<li>
<h2 id="53-%E7%B5%8C%E8%B7%AF%E6%8E%A2%E6%9F%BB%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%9F%E3%82%AB%E3%83%A1%E3%83%A9%E7%A7%BB%E5%8B%95-a-id%22routeexploration%22a">5.3. 経路探査を使ったカメラ移動  <a id="RouteExploration"></a></h2>
</li>
</ul>
<p>ゲームスタート時に、各拠点の紹介(鍛えれる筋肉)と、ステージの紹介を兼ねて、カメラの座標に経路探査のパスを入れて移動させています。
<img src="gif/RouteExploration.gif" width="720"></p>
<ul>
<li>
<h2 id="54-%E6%95%B5%E3%81%8C%E7%99%BA%E5%A3%B0%E3%81%99%E3%82%8Bse-a-id%22enemyse%22a">5.4. 敵が発声するSE  <a id="EnemySE"></a></h2>
</li>
</ul>
<p>大量に敵が現れるため、SEが重なり、音割れが起こることが多々ありました。<br/>
そのため、シングルトンパターンで作成したEnemySEManagerで敵のSEの最大発生数を定め、管理できるようにしました。</p>
<ul>
<li>
<h2 id="55-%E3%83%97%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%81%AE%E6%94%BB%E6%92%83-a-id%22playerattack%22a">5.5. プレイヤーの攻撃  <a id="PlayerAttack"></a></h2>
</li>
</ul>
<p>プレイヤーの攻撃の3発目に波紋状に衝撃波が出るようにしました。<br/>
当たり判定には、ボックスコライダーを使い、ボックスが徐々に大きくなります。<br/>
3発目を打った後はスキが大きいので敵に囲まれないようにする必要があります。</p>
 <img src="gif/PlayerAttack.gif" width="720">
<ul>
<li>
<h2 id="56-%E3%83%9F%E3%83%8B%E3%83%9E%E3%83%83%E3%83%97-a-id%22minimap%22a">5.6. ミニマップ    <a id="MiniMap"></a></h2>
<p>3dsMaxでステージを正投影描写したものをドット変換した後、アウトライン、道、を塗りそれぞれの拠点に鍛えられる筋肉のアイコンを追加しました。
<img src="image/MiniMap.png" width="720"></p>
<img src="gif/MiniMap.gif" width="720">
</li>
</ul>

</body>
</html>
